<!DOCTYPE html><html lang="en"><head><script async src="/scripts.js"></script><meta charset="utf-8"><title>Incremental Formatting and Process Plugins - dprint 0.7 - dprint - Code Formatter</title><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="theme-color" content="#000000"><meta name="description" content="Overview of the new features in dprint 0.7"><meta name="author" content="Dprint Code Formatting"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="@dprintfmt"><meta name="twitter:title" content="Incremental Formatting and Process Plugins - dprint 0.7"><meta name="twitter:description" content="Overview of the new features in dprint 0.7"><link rel="stylesheet" href="/style.css"></head><body><nav class="navbar" role="navigation" aria-label="main navigation"><div class="navbar-brand"><h1 class="title"><a href="/">dprint</a></h1><a role="button" id="navbarBurger" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarLinks"><span aria-hidden="true"></span> <span aria-hidden="true"></span> <span aria-hidden="true"></span></a></div><div class="navbar-menu" id="navbarLinks"><div class="navbar-end"><a class="navbar-item" href="/overview">Overview</a> <a class="navbar-item" href="/playground">Playground</a> <a class="navbar-item" href="/sponsor">Sponsor</a> <a class="navbar-item" href="https://github.com/dprint/dprint" rel="noopener noreferrer">View on GitHub</a></div></div></nav><section class="section" id="content"><article id="content-body" class="container"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/blog">Blog</a></li></ul></nav><h1 class="title">Incremental Formatting and Process Plugins - dprint 0.7</h1><div class="blog-date-author"><time datetime="2020-08-05">2020-08-05</time> by <a href="https://github.com/dsherret">David Sherret</a></div><p>dprint is a pluggable, configurable, and fast code formatting platform written in Rust.</p><p>This post will outline the new features in dprint 0.7.</p><h2 id="incremental">Incremental</h2><p>When formatting a collection of files, there's not much point formatting a file that hasn't changed.</p><p>The CLI now has an "incremental" feature that only formats files that haven't changed since the last time they were formatted.</p><p>To use it, you may specify <code>"incremental": true</code> in your <code>.dprintrc.json</code> file (recommended):</p><pre><code class="jsonc language-jsonc">{
  <span class="hljs-comment">// etc...</span>
  <span class="hljs-attr">&quot;incremental&quot;</span>: <span class="hljs-literal">true</span>
  <span class="hljs-comment">// etc...</span>
}</code></pre><p>This is specified by default when using <code>dprint init</code>.</p><p>Alternatively, use the <code>--incremental</code> flag on the CLI:</p><pre><code class="bash language-bash">dprint fmt --incremental</code></pre><p>Using this will drastically speed up performance. For example, in <a href="https://github.com/denoland/deno">Deno</a>'s internal code, using it brought down formatting from ~2.4s to ~0.1s on the second run on my machine.</p><p>This incremental information is stored in dprint's cache folder. You may clear the cache by running <code>dprint clear-cache</code>.</p><h2 id="process-plugins">Process Plugins</h2><p>dprint has previously only supported plugins compiled to a single <code>.wasm</code> file. Unfortunately, this has been limiting because not many languages support cleanly compiling to a <code>.wasm</code> file yet (for example, it's impossible to do this in C# at the time of this post).</p><p>To get around this, a new type of plugin called "process plugins" has been introduced. These are plugins that work by the CLI executing a separate process and then communicating with it via stdin and stdout.</p><p>Obviously, process plugins are not as secure as WASM plugins since they don't run sandboxed. To at least ensure the process plugin being used is the same that was built with the CI pipeline, you must specify the checksum of the file in addition to a URL. For example:</p><pre><code class="jsonc language-jsonc">{
  <span class="hljs-comment">// etc...</span>
  <span class="hljs-attr">&quot;plugins&quot;</span>: [
    <span class="hljs-string">&quot;https://plugins.dprint.dev/roslyn-3.6.0.exe-plugin@2ef95b9c2ebfbd50a2bef422c8ad066563bf4d452da44386243e6d7915b0d62b&quot;</span>
  ]
}</code></pre><p>Yeah, kind of annoying, but overall not too bad if you copy and paste. The instructions for setting this up are outlined on each plugin's page.</p><p>At the moment there are two process plugins (these should both work on Windows, Linux, and Mac):</p><ul><li><a href="https://github.com/dprint/dprint-plugin-roslyn">dprint-plugin-roslyn</a> - C# and Visual Basic formatting using the <a href="https://github.com/dotnet/roslyn">Roslyn</a> compiler.</li><li><a href="https://github.com/dprint/dprint-plugin-prettier">dprint-plugin-prettier</a> - Formats all the many languages <a href="https://prettier.io">Prettier</a> supports. Note: if you wish to use this with plugins like <code>dprint-plugin-typescript</code>, then specify this after those plugins in the <code>"plugins"</code> array of the configuration file.</li></ul><h2 id="immediate-future">Immediate Future</h2><p>I've already started work on a <a href="https://golang.org/cmd/gofmt/">gofmt</a> plugin. It will be released over the next few weeks when I find the time to finish it.</p><p>Thanks for reading!</p></article></section><footer class="footer"><div><div class="level"><div class="level-left"><p class="level-item"><a href="/">Home</a></p><p class="level-item"><a href="/contact">Contact Us</a></p><p class="level-item"><a href="/privacy-policy">Privacy Policy</a></p></div><div class="level-right"><p class="level-item"><a href="/blog">Blog</a></p><p class="level-item"><a href="https://twitter.com/dprintfmt">Twitter</a></p><p class="level-item"><a href="https://github.com/dprint">GitHub</a></p></div></div></div></footer></body></html>