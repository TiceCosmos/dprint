(this.webpackJsonpplayground=this.webpackJsonpplayground||[]).push([[2],{24:function(e,t,n){e.exports=n(60)},53:function(e,t,n){},57:function(e,t,n){},58:function(e,t,n){},60:function(e,t,n){"use strict";n.r(t);var r,o=n(22),a=n(4),i=n(0),l=n.n(i),s=n(18),c=n.n(s),u=n(9),d=n(10),p=n(11),f=n(12),h=n(23),g=n(21),m=n(19);function v(e){var t=e.backgroundColor;return l.a.createElement("div",{className:"verticallyCenter horizontallyCenter fillHeight",style:{backgroundColor:t}},l.a.createElement(m.BeatLoader,{color:"#fff",loading:!0,size:25}))}!function(e){e.TypeScript="typescript",e.Json="json",e.Markdown="markdown"}(r||(r={}));var y=function(e){Object(h.a)(o,e);var t=Object(g.a)(o);function o(e){var a;Object(d.a)(this,o),(a=t.call(this,e)).editor=void 0,a.monacoEditor=void 0,a.outerContainerRef=l.a.createRef(),a.disposables=[],a.lastScrollTop=0,a.state={editorComponent:void 0},a.editorDidMount=a.editorDidMount.bind(Object(f.a)(a));var i=Promise.all([n.e(0),n.e(6)]).then(n.t.bind(null,377,7));return Promise.all([n.e(0),n.e(5)]).then(n.t.bind(null,378,7)).then((function(e){a.monacoEditor=e,a.props.language===r.TypeScript&&(e.languages.typescript.typescriptDefaults.setCompilerOptions({noLib:!0,target:e.languages.typescript.ScriptTarget.ESNext,allowNonTsExtensions:!0}),e.languages.typescript.typescriptDefaults.setDiagnosticsOptions({noSyntaxValidation:!0,noSemanticValidation:!0})),e.editor.defineTheme("dprint-theme",{base:"vs-dark",inherit:!0,rules:[],colors:{"editorRuler.foreground":"#283430"}}),i.then((function(e){a.setState({editorComponent:e.default})})).catch((function(e){console.error(e),a.setState({editorComponent:!1})}))})).catch((function(e){console.error(e),a.setState({editorComponent:!1})})),a}return Object(p.a)(o,[{key:"render",value:function(){return this.updateScrollTop(),this.updateJsonSchema(),l.a.createElement("div",{className:"codeEditor",ref:this.outerContainerRef},this.getEditor())}},{key:"componentWillUnmount",value:function(){var e,t=Object(u.a)(this.disposables);try{for(t.s();!(e=t.n()).done;){e.value.dispose()}}catch(n){t.e(n)}finally{t.f()}this.disposables.length=0}},{key:"getEditor",value:function(){var e=this;return null==this.state.editorComponent?l.a.createElement(v,{backgroundColor:"#1e1e1e"}):!1===this.state.editorComponent?l.a.createElement("div",{className:"errorMessage"},"Error loading code editor. Please refresh the page to try again."):l.a.createElement(this.state.editorComponent,{width:"100%",height:"100%",value:this.props.text,theme:"dprint-theme",language:this.props.language,onChange:function(t){return e.props.onChange&&e.props.onChange(t)},editorDidMount:this.editorDidMount,options:{automaticLayout:!1,renderWhitespace:"all",readOnly:this.props.readonly||!1,minimap:{enabled:!1},quickSuggestions:!1,rulers:null==this.props.lineWidth?[]:[this.props.lineWidth]}})}},{key:"editorDidMount",value:function(e){var t=this;this.editor=e,this.disposables.push(this.editor.onDidChangeModelContent((function(){t.props.readonly&&t.editor.setPosition({column:1,lineNumber:1})}))),this.disposables.push(this.editor.onDidScrollChange((function(e){e.scrollTopChanged&&t.props.onScrollTopChange&&t.props.onScrollTopChange(e.scrollTop)})));var n=0,r=0,o=setInterval((function(){var o=t.outerContainerRef.current;if(null!=o){var a=o.offsetWidth,i=o.offsetHeight;n===i&&r===a||(e.layout(),n=i,r=a)}}),500);this.disposables.push({dispose:function(){return clearInterval(o)}})}},{key:"updateScrollTop",value:function(){var e=this;null!=this.editor&&this.lastScrollTop!==this.props.scrollTop&&setTimeout((function(){null!=e.props.scrollTop&&(e.editor.setScrollTop(e.props.scrollTop),e.lastScrollTop=e.props.scrollTop)}),0)}},{key:"updateJsonSchema",value:function(){var e,t;null!=this.monacoEditor&&null!=this.props.jsonSchemaUrl&&((null===(e=this.monacoEditor.languages.json.jsonDefaults.diagnosticsOptions.schemas)||void 0===e||null===(t=e[0])||void 0===t?void 0:t.uri)!==this.props.jsonSchemaUrl&&this.monacoEditor.languages.json.jsonDefaults.setDiagnosticsOptions({validate:!0,allowComments:!0,enableSchemaRequest:!0,schemas:[{uri:this.props.jsonSchemaUrl,fileMatch:["*"]}]}))}}]),o}(l.a.Component);function b(e){return l.a.createElement("a",{id:e.id,href:e.url,rel:"noopener noreferrer"},e.text)}var E=new Worker("/playground/formatter.worker.js"),j=[],S=[];E.addEventListener("message",(function(e){switch(e.data.type){case"Format":var t,n=Object(u.a)(j);try{for(n.s();!(t=n.n()).done;){(0,t.value)(e.data.text)}}catch(a){n.e(a)}finally{n.f()}break;case"Error":var r,o=Object(u.a)(S);try{for(o.s();!(r=o.n()).done;){(0,r.value)(e.data.message)}}catch(a){o.e(a)}finally{o.f()}}}));n(53);var x=n(15);n(57),n(58);function O(e){var t=e.configText,n=e.onConfigTextChanged,o=e.text,s=e.onTextChanged,c=e.formattedText,u=e.fileExtensions,d=e.selectedPlugin,p=e.plugins,f=e.onSelectPlugin,h=e.isLoading,g=Object(i.useState)(0),m=Object(a.a)(g,2),j=m[0],S=m[1],O=Object(i.useState)(void 0),T=Object(a.a)(O,2),w=T[0],C=T[1];Object(i.useEffect)((function(){C(u[0])}),[u]),Object(i.useEffect)((function(){var e=setTimeout((function(){var e,t,n;t=null!==(e="file."+w)&&void 0!==e?e:"ts",n=o,E.postMessage({type:"Format",filePath:t,fileText:n})}),250);return function(){return clearTimeout(e)}}),[w,o]),Object(i.useEffect)((function(){var e=setTimeout((function(){var e;try{null==(e=JSON.parse(t)).lineWidth&&(e.lineWidth=80),function(e){E.postMessage({type:"SetConfig",config:e})}(e)}catch(n){}}),250);return function(){return clearTimeout(e)}}),[t]);var k=Object(i.useMemo)((function(){try{var e=parseInt(JSON.parse(t).lineWidth,10);if(!isNaN(e))return e}catch(n){}return 80}),[t]),N=Object(i.useCallback)((function(e){C(e.target.value)}),[C]);return l.a.createElement("div",{className:"App"},l.a.createElement(x.a,{split:"horizontal",defaultSize:53,allowResize:!1},l.a.createElement("header",{className:"appHeader"},l.a.createElement("h1",{id:"title"},"dprint - Playground"),l.a.createElement("div",{id:"headerRight"},l.a.createElement("a",{href:"/overview"},"Overview"),l.a.createElement("a",{href:"/playground"},"Playground"),l.a.createElement("a",{href:"/sponsor"},"Sponsor"),l.a.createElement(b,{url:"https://github.com/dprint/dprint",text:"View on GitHub"}))),l.a.createElement(x.a,{split:"vertical",minSize:50,defaultSize:"50%",allowResize:!0,pane1Style:{overflowX:"hidden",overflowY:"hidden"},pane2Style:{overflowX:"hidden",overflowY:"hidden"}},l.a.createElement(x.a,{split:"horizontal",allowResize:!0,defaultSize:"60%",pane1Style:{overflowX:"hidden",overflowY:"hidden"},pane2Style:{overflowX:"hidden",overflowY:"hidden"}},l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"playgroundSubTitle"},l.a.createElement("div",{className:"row"},l.a.createElement("div",{className:"column"},"Plugin:"),l.a.createElement("div",{className:"column",style:{flex:1,display:"flex"}},l.a.createElement("select",{onChange:function(e){return f(p[e.target.selectedIndex])},style:{flex:1},value:d.url},p.map((function(e,t){return l.a.createElement("option",{key:t,value:e.url},e.url)})))),l.a.createElement("div",{className:"column",style:{display:"flex"}},l.a.createElement("select",{value:w,onChange:N},u.map((function(e,t){return l.a.createElement("option",{key:t,value:e},".",e)})))))),l.a.createElement(y,{language:d.language,onChange:s,text:o,lineWidth:k,onScrollTopChange:S,scrollTop:j})),l.a.createElement("div",{className:"container"},l.a.createElement("div",{className:"playgroundSubTitle"},"Configuration"),l.a.createElement(y,{language:r.Json,onChange:n,jsonSchemaUrl:d.configSchemaUrl,text:t}))),l.a.createElement("div",{className:"container"},h?l.a.createElement(v,null):l.a.createElement(y,{language:d.language,text:c,readonly:!0,lineWidth:k,onScrollTopChange:S,scrollTop:j})))))}var T=n(7),w=n.n(T),C=n(13);function k(){return(k=Object(C.a)(w.a.mark((function e(t){var n,r,o,a,i,l,s,c,u,d;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t.configSchemaUrl);case 2:return n=e.sent,e.next=5,n.json();case 5:r=e.sent,o="{",a=!1,i=0,l=Object.keys(r.properties);case 9:if(!(i<l.length)){e.next=20;break}if("$schema"!==(s=l[i])&&"deno"!==s&&"locked"!==s){e.next=13;break}return e.abrupt("continue",17);case 13:c=r.properties[s],u=void 0,null!=(u=c.$ref?null===(d=r.definitions[s])||void 0===d?void 0:d.default:c.default)&&(o+=a?",\n":"\n",o+='  "'.concat(s,'": '),o+="string"===typeof u?'"'.concat(u,'"'):"lineWidth"===s?"80":"".concat(u.toString()),a=!0);case 17:i++,e.next=9;break;case 20:return o+="\n}\n",e.abrupt("return",o);case 22:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return(N=Object(C.a)(w.a.mark((function e(){var t,n,o,a,i;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://plugins.dprint.dev/info.json");case 2:return t=e.sent,e.next=5,t.json();case 5:if(n=e.sent,3,3===n.schemaVersion){e.next=9;break}throw new Error("Expected schema version ".concat(3,", but found ").concat(n.schemaVersion,"."));case 9:return o=n.latest.find((function(e){return"typescript"===e.configKey})),a=n.latest.find((function(e){return"json"===e.configKey})),i=n.latest.find((function(e){return"markdown"===e.configKey})),e.abrupt("return",[{url:o.url,configSchemaUrl:"https://plugins.dprint.dev/schemas/typescript-v0.json",language:r.TypeScript,fileExtensions:o.fileExtensions},{url:a.url,configSchemaUrl:"https://plugins.dprint.dev/schemas/json-v0.json",language:r.Json,fileExtensions:a.fileExtensions},{url:i.url,configSchemaUrl:"https://plugins.dprint.dev/schemas/markdown-v0.json",language:r.Markdown,fileExtensions:i.fileExtensions}]);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var U=n(14);function M(e){return Object(U.decompressFromEncodedURIComponent)(e.trim())||""}var D=new(function(){function e(){Object(d.a)(this,e)}return Object(p.a)(e,[{key:"getUrlInfo",value:function(){var e=document.location.hash||"";return{text:function(){var t=/code\/([^/]+)/.exec(e);if(null==t||2!==t.length)return"";try{return M(t[1])}catch(n){return console.error(n),""}}(),configText:function(){var t=/config\/([^/]+)/.exec(e);if(null==t||2!==t.length)return;try{return M(t[1])}catch(n){return void console.error(n)}}(),language:function(){var t=/language\/([^/]+)/.exec(e);if(null==t||2!==t.length)return"typescript";try{switch(t[1]){case"json":return"json";case"markdown":return"markdown";case"typescript":default:return"typescript"}}catch(n){return console.error(n),"typescript"}}()}}},{key:"updateUrl",value:function(e){var t=e.text,n=e.configText,r=e.language;if(null==r)window.history.replaceState(void 0,"","");else{var o="#code/".concat(Object(U.compressToEncodedURIComponent)(t));null!=n&&(o+="/config/".concat(Object(U.compressToEncodedURIComponent)(n))),o+="/language/".concat(r),window.history.replaceState(void 0,"",o)}}}]),e}()),R=D.getUrlInfo(),P=!0;function W(){var e,t=Object(i.useState)([]),n=Object(a.a)(t,2),r=n[0],s=n[1],c=Object(i.useState)(),u=Object(a.a)(c,2),d=u[0],p=u[1],f=Object(i.useState)([]),h=Object(a.a)(f,2),g=h[0],m=h[1],y=Object(i.useState)(R.text),b=Object(a.a)(y,2),x=b[0],T=b[1],w=Object(i.useState)(null!==(e=R.configText)&&void 0!==e?e:""),C=Object(a.a)(w,2),U=C[0],M=C[1],W=Object(i.useState)(""),z=Object(a.a)(W,2),I=z[0],J=z[1],L=Object(i.useState)(""),V=Object(a.a)(L,2),H=V[0],X=V[1],Y=Object(i.useState)(!0),F=Object(a.a)(Y,2),K=F[0],q=F[1];return Object(i.useEffect)((function(){(function(){return N.apply(this,arguments)})().then((function(e){s(e),p(e.find((function(e){var t;return null!==(t=e.language===R.language)&&void 0!==t?t:"typescript"})))})).catch((function(e){console.error(e),alert("There was an error getting the plugins. Try refreshing the page or check the browser console.")}))}),[]),Object(i.useEffect)((function(){var e;e=function(e){X(e)},j.push(e),function(e){S.push(e)}((function(e){console.error(e),alert("There was an error with the formatter worker. Try refreshing the page or check the browser console.")}))}),[]),Object(i.useEffect)((function(){null!=d&&D.updateUrl({text:x,configText:U===I?void 0:U,language:d.language})}),[x,U,d,I]),Object(i.useEffect)((function(){if(q(!0),null!=d){var e,t=function(e){return k.apply(this,arguments)}(d);e=d.url,E.postMessage({type:"LoadUrl",url:e}),t.then((function(e){m(Object(o.a)(d.fileExtensions)),P&&null!=R.configText?(M(R.configText),P=!1):M(e),J(e),q(!1)})).catch((function(e){console.error(e),alert("There was an error loading the plugin. Check the console or try refreshing the page.")}))}}),[d]),null==d?l.a.createElement(v,null):l.a.createElement(O,{text:x,onTextChanged:T,configText:U,onConfigTextChanged:M,formattedText:H,fileExtensions:g,plugins:r,selectedPlugin:d,onSelectPlugin:p,isLoading:K})}c.a.render(l.a.createElement(W,null),document.getElementById("root"))}},[[24,3,4]]]);
//# sourceMappingURL=main.3907338c.chunk.js.map